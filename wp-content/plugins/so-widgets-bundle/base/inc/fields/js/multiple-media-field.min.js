!function(i){i(document).on("sowsetupformfield",".siteorigin-widget-field-type-multiple_media",(function(t){var e=i(this),a=e.find(".siteorigin-widget-input"),n=a.val().split(",");e.data("initialized")||(e.find(".button").on("click",(function(t){if(t.preventDefault(),void 0!==wp.media){var l=i(this),d=i(this).data("frame");if(d)return d.open(),!1;(d=wp.media({title:l.data("choose"),library:{type:l.data("library").split(",").map((function(i){return i.trim()}))},multiple:!0,button:{text:l.data("update"),close:!1}})).on("open",(function(){if(n.length){var t=d.state().get("selection");i.each(n,(function(){t.add(wp.media.attachment(this))}))}})),l.data("frame",d),d.on("select",(function(){var t,l,o,m,u=[];i.each(d.state().get("selection").models,(function(){t=this.attributes,-1==n.indexOf(t.id.toString())&&(e.find(".multiple-media-field-template .multiple-media-field-item").clone().appendTo(e.find(".multiple-media-field-items")),o=e.find(".multiple-media-field-items .multiple-media-field-item").last(),(m=o.find(".thumbnail")).attr("title",t.title),o.find(".title").text(t.title),o.attr("data-id",t.id),l=void 0!==t.sizes?void 0!==t.sizes.thumbnail?t.sizes.thumbnail.url:t.sizes.full.url:t.icon,m.attr("src",l)),u.push(t.id)})),e.find(".multiple-media-field-items .multiple-media-field-item").each((function(){-1==u.indexOf(i(this).data("id"))&&i(this).remove()})),u.length?(n=u,a.val(u.join(","))):(n=[],a.val("")),d.close()})),d.open()}})),i(document).on("click",".siteorigin-widget-field-type-multiple_media a.media-remove-button",(function(t){t.preventDefault();var e=i(this).parent();n.splice(n.indexOf(e.data("id"))),a.val(n.join(",")),e.remove()})),e.data("initialized",!0))}))}(jQuery);