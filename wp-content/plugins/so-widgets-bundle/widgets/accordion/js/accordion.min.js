var sowb=window.sowb||{};jQuery((function(o){sowb.setupAccordion=function(){o(".sow-accordion").each((function(n,e){var i=o(this).closest(".so-widget-sow-accordion");if(i.data("initialized"))return o(this);var a=o(e).find("> .sow-accordion-panel"),c=a.filter(".sow-accordion-panel-open").toArray(),r=function(n,e,a){var s=o(n);if(!s.is(".sow-accordion-panel-open")){s.find("> .sow-accordion-panel-content").slideDown({start:function(){sowAccordion.scrollto_after_change&&o(window).trigger("resize"),o(sowb).trigger("setup_widgets")},complete:function(){a&&sowAccordion.scrollto_after_change&&(s.offset().top<window.scrollY||s.offset().top+s.height()>window.scrollY)&&function(n,e){var i=sowAccordion.scrollto_offset?sowAccordion.scrollto_offset:80,a=n.offset().top-i;e?o("body,html").animate({scrollTop:a},200):window.scrollTo(0,a)}(s,!0),o(this).trigger("show")}}),s.find("> .sow-accordion-panel-header-container > .sow-accordion-panel-header").attr("aria-expanded",!0),s.addClass("sow-accordion-panel-open"),c.push(n);var t=o(n).parents(".sow-accordion-panel");t.length&&!t.hasClass("sow-accordion-panel-open")&&r(t.get(0),!0),e||i.trigger("accordion_open",[n,i])}},s=function(n,e){var a=o(n);a.is(".sow-accordion-panel-open")&&(a.find("> .sow-accordion-panel-content").slideUp((function(){o(this).trigger("hide")})),a.find("> .sow-accordion-panel-header-container > .sow-accordion-panel-header").attr("aria-expanded",!1),a.removeClass("sow-accordion-panel-open"),c.splice(c.indexOf(n),1),e||i.trigger("accordion_close",[n,i]))};a.find("> .sow-accordion-panel-header-container > .sow-accordion-panel-header").on("click keydown",(function(n){if("keydown"==n.type){if("Enter"!==n.key&&"Space"!==n.key)return;n.preventDefault()}var e=o(this),a=i.data("maxOpenPanels"),t=e.closest(".sow-accordion-panel");if(t.is(".sow-accordion-panel-open")?s(t.get(0)):r(t.get(0),!1,!0),!isNaN(a)&&a>0&&c.length>a){var d=0;o.each(c.reverse(),(function(o,n){d!==a?d++:s(c[o])}))}})),i.data("initialized",!0)}))},sowb.setupAccordion(),o(sowb).on("setup_widgets",sowb.setupAccordion)})),window.sowb=sowb;