var sowb=window.sowb||{};jQuery((function(s){sowb.setupCarousel=function(){s(".sow-carousel-wrapper").each((function(){var e=s(this);$items=e.find(".sow-carousel-items"),$items.not(".slick-initialized").slick({arrows:!1,infinite:!1,rows:0,rtl:"rtl"==e.data("dir"),touchThreshold:20,variableWidth:!0,responsive:[{breakpoint:carouselBreakpoints.tablet_portrait,settings:{slidesToScroll:2,slidesToShow:2}},{breakpoint:carouselBreakpoints.mobile,settings:{slidesToScroll:1,slidesToShow:1}}]}),$items.on("swipe",(function(s,i,t){e.parent().parent().find(".sow-carousel-"+("left"==t?"next":"prev")).trigger("touchend")})),e.parent().parent().find(".sow-carousel-previous, .sow-carousel-next").on("click touchend",(function(i){i.preventDefault(),$items=e.find(".sow-carousel-items");var t=$items.find(".sow-carousel-item").length,o=e.data("post-count");if(complete=t===o,numVisibleItems=Math.ceil($items.outerWidth()/$items.find(".sow-carousel-item").outerWidth(!0)),lastPosition=t-numVisibleItems+1,!complete&&$items.slick("slickCurrentSlide")+numVisibleItems>=t-1&&!e.data("fetching")){e.data("fetching",!0);var a=e.data("page")+1;$items.slick("slickAdd",'<div class="sow-carousel-item sow-carousel-loading"></div>'),s.get(e.data("ajax-url"),{action:"sow_carousel_load",paged:a,instance_hash:e.parent().parent().find('input[name="instance_hash"]').val()},(function(s,i){$items.find(".sow-carousel-loading").remove(),$items.slick("slickAdd",s.html),t=e.find(".sow-carousel-item").length,e.data("fetching",!1),e.data("page",a)}))}s(this).hasClass("sow-carousel-next")?$items.slick("slickCurrentSlide")>=lastPosition?e.data("loop-posts-enabled")&&!e.data("fetching")&&$items.slick("slickGoTo",0):$items.slick("slickNext"):s(this).hasClass("sow-carousel-previous")&&(e.data("loop-posts-enabled")&&0==$items.slick("slickCurrentSlide")?$items.slick("slickGoTo",lastPosition-(complete?0:1)):$items.slick("slickPrev"))}))})),s(window).on("resize load",(function(){var e=s(".sow-carousel-wrapper"),i=e.find(".sow-carousel-items"),t=Math.ceil(i.outerWidth()/i.find(".sow-carousel-item").outerWidth(!0)),o=e.parent().parent().find(".sow-carousel-navigation");t>=e.data("post-count")?(o.hide(),i.slick("slickSetOption","touchMove",!1),i.slick("slickSetOption","draggable",!1)):o.not(":visible")&&(o.show(),i.slick("slickSetOption","touchMove",!0),i.slick("slickSetOption","draggable",!0)),window.matchMedia("(min-width: "+carouselBreakpoints.tablet_portrait+"px) and (max-width: "+carouselBreakpoints.tablet_landscape+"px) and (orientation: landscape)").matches&&(s(".sow-carousel-items").slick("slickSetOption","slidesToShow",3),s(".sow-carousel-items").slick("slickSetOption","slidesToScroll",3))}))},sowb.setupCarousel(),s(sowb).on("setup_widgets",sowb.setupCarousel)})),window.sowb=sowb;